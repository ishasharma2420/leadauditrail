



â€‹<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Intelligence Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,400;12..96,500;12..96,600;12..96,700;12..96,800&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
 Â Â  --bg: #f5f6f8; --white: #ffffff; --border: #e8eaef; --border-soft: #f0f1f4;
 Â Â  --text: #0f1117; --text-muted: #7b8194; --text-dim: #9da3b4;
 Â Â  --flash: #0066ff; --flash-light: #eff4ff; --flash-mid: #dbeafe; --flash-border: #bfdbfe;
 Â Â  --sherlock: #7c3aed; --sherlock-light: #f5f0ff; --sherlock-border: #ddd6fe;
 Â Â  --hawke: #059669; --hawke-light: #ecfdf5; --hawke-mid: #d1fae5; --hawke-border: #a7f3d0;
 Â Â  --invorto: #ea580c; --invorto-light: #fff7ed; --invorto-border: #fdba74;
 Â Â  --sev-high-bg:#fef2f2; --sev-high:#dc2626; --sev-high-border:#fecaca;
 Â Â  --sev-med-bg:#fffbeb; --sev-med:#d97706; --sev-med-border:#fde68a;
 Â Â  --sev-low-bg:#f0fdf4; --sev-low:#16a34a; --sev-low-border:#bbf7d0;
  }
  * { margin:0; padding:0; box-sizing:border-box; }
  body { background:var(--bg); color:var(--text); font-family:'Inter',sans-serif; font-size:13px; line-height:1.5; min-height:100vh; }
  .wrapper { padding:14px; }

  .header { display:flex; align-items:center; justify-content:space-between; margin-bottom:12px; }
  .header-left { display:flex; align-items:center; gap:8px; }
  .pulse-ring { position:relative; width:10px; height:10px; flex-shrink:0; }
  .pulse-ring::before { content:''; position:absolute; inset:0; background:var(--flash); border-radius:50%; animation:pulse 2s ease-in-out infinite; }
  .pulse-ring::after { content:''; position:absolute; inset:-3px; border:1.5px solid var(--flash); border-radius:50%; opacity:0; animation:pulse-ring 2s ease-in-out infinite; }
  @keyframes pulse { 0%,100%{transform:scale(1);opacity:1;} 50%{transform:scale(0.85);opacity:0.7;} }
  @keyframes pulse-ring { 0%{transform:scale(0.7);opacity:0.8;} 100%{transform:scale(1.4);opacity:0;} }
  .header-title { font-family:'Bricolage Grotesque',sans-serif; font-size:13px; font-weight:700; }
  .header-sub { font-size:11px; color:var(--text-muted); }

  .stack { display:flex; flex-direction:column; gap:10px; }

  .card { background:var(--white); border-radius:14px; border:1px solid var(--border); overflow:hidden; transition:box-shadow 0.2s,transform 0.2s; animation:fadeUp 0.4s ease both; }
  .card:hover { transform:translateY(-1px); box-shadow:0 4px 20px rgba(0,0,0,0.07); }
  .card:nth-child(1){animation-delay:0.04s;} .card:nth-child(2){animation-delay:0.08s;} .card:nth-child(3){animation-delay:0.12s;} .card:nth-child(4){animation-delay:0.16s;}
  @keyframes fadeUp { from{opacity:0;transform:translateY(8px);} to{opacity:1;transform:translateY(0);} }

  .card-bar { height:3px; }
  .bar-flash{background:linear-gradient(90deg,var(--flash),#60a5fa);}
  .bar-sherlock{background:linear-gradient(90deg,var(--sherlock),#a78bfa);}
  .bar-hawke{background:linear-gradient(90deg,var(--hawke),#34d399);}
  .bar-invorto{background:linear-gradient(90deg,var(--invorto),#fb923c);}

  .card-head { display:flex; align-items:center; justify-content:space-between; padding:12px 14px 10px; border-bottom:1px solid var(--border-soft); }
  .agent-id { display:flex; align-items:center; gap:9px; }
  .agent-icon { width:30px; height:30px; border-radius:8px; display:flex; align-items:center; justify-content:center; font-size:14px; flex-shrink:0; }
  .icon-flash{background:var(--flash-light);} .icon-sherlock{background:var(--sherlock-light);} .icon-hawke{background:var(--hawke-light);} .icon-invorto{background:var(--invorto-light);}
  .agent-name { font-family:'Bricolage Grotesque',sans-serif; font-size:13px; font-weight:700; line-height:1.2; }
  .agent-role { font-size:10.5px; color:var(--text-muted); margin-top:1px; }

  .pill { font-size:10px; font-weight:600; letter-spacing:0.05em; text-transform:uppercase; padding:3px 8px; border-radius:20px; }
  .pill-active{background:#dcfce7;color:#15803d;} .pill-review{background:var(--sev-med-bg);color:var(--sev-med);} .pill-pending{background:#fef9c3;color:#a16207;} .pill-none{background:var(--bg);color:var(--text-muted);}

  .card-body { padding:12px 14px 14px; }

  /* Loading */
  .loading { text-align:center; padding:40px 20px; color:var(--text-muted); }
  .spinner { width:24px; height:24px; border:2px solid var(--border); border-top-color:var(--flash); border-radius:50%; animation:spin 0.8s linear infinite; margin:0 auto 10px; }
  @keyframes spin { to{transform:rotate(360deg);} }

  /* All empty */
  .all-empty { text-align:center; padding:48px 24px; }
  .all-empty-emoji { font-size:36px; margin-bottom:10px; animation:float 3s ease-in-out infinite; }
  @keyframes float { 0%,100%{transform:translateY(0);} 50%{transform:translateY(-5px);} }
  .all-empty-title { font-family:'Bricolage Grotesque',sans-serif; font-size:14px; font-weight:700; color:var(--text-muted); margin-bottom:4px; }
  .all-empty-sub { font-size:12px; color:var(--text-dim); }

  .score-hero { display:flex; align-items:center; gap:10px; background:var(--flash-light); border:1px solid var(--flash-border); border-radius:10px; padding:10px 12px; margin-bottom:11px; }
  .score-ring { position:relative; width:46px; height:46px; flex-shrink:0; }
  .score-ring svg { width:46px; height:46px; transform:rotate(-90deg); }
  .ring-bg { fill:none; stroke:var(--flash-border); stroke-width:3.5; }
  .ring-fill { fill:none; stroke:var(--flash); stroke-width:3.5; stroke-linecap:round; transition:stroke-dashoffset 1s cubic-bezier(.4,0,.2,1); }
  .score-num { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-family:'Bricolage Grotesque',sans-serif; font-size:13px; font-weight:800; color:var(--flash); }
  .score-label { font-size:10px; color:var(--text-muted); text-transform:uppercase; letter-spacing:0.07em; }
  .score-bucket { font-family:'Bricolage Grotesque',sans-serif; font-size:16px; font-weight:800; line-height:1.1; margin-top:2px; }
  .bkt-high{color:var(--flash);} .bkt-medium{color:var(--sev-med);} .bkt-low{color:var(--text-muted);}

  .fields { display:flex; flex-direction:column; gap:9px; }
  .field { display:flex; flex-direction:column; gap:2px; }
  .f-label { font-size:10px; font-weight:600; letter-spacing:0.07em; text-transform:uppercase; color:var(--text-muted); }
  .f-val { font-size:12px; color:var(--text); line-height:1.4; }
  .f-val.c-flash{color:var(--flash);font-weight:500;} .f-val.c-sherlock{color:var(--sherlock);font-weight:500;} .f-val.c-hawke{color:var(--hawke);font-weight:500;} .f-val.c-invorto{color:var(--invorto);font-weight:500;}

  .conf-wrap { display:flex; align-items:center; gap:7px; margin-top:3px; }
  .conf-track { flex:1; height:5px; background:var(--border); border-radius:3px; overflow:hidden; }
  .conf-fill { height:100%; border-radius:3px; transition:width 1s cubic-bezier(.4,0,.2,1); }
  .cf-hawke { background:linear-gradient(90deg,var(--hawke-mid),var(--hawke)); }
  .conf-num { font-family:'Bricolage Grotesque',sans-serif; font-size:12px; font-weight:700; min-width:26px; text-align:right; color:var(--hawke); }

  .two-col { display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-bottom:10px; }

  .badge { display:inline-flex; align-items:center; gap:4px; padding:2px 8px; border-radius:4px; font-size:10px; font-weight:700; letter-spacing:0.06em; text-transform:uppercase; }
  .badge::before { content:''; width:4px; height:4px; border-radius:50%; background:currentColor; }
  .badge-high{background:var(--sev-high-bg);color:var(--sev-high);border:1px solid var(--sev-high-border);}
  .badge-medium{background:var(--sev-med-bg);color:var(--sev-med);border:1px solid var(--sev-med-border);}
  .badge-low{background:var(--sev-low-bg);color:var(--sev-low);border:1px solid var(--sev-low-border);}

  .anomaly-chip { display:inline-block; background:var(--hawke-light); border:1px solid var(--hawke-border); border-radius:6px; padding:3px 9px; font-family:'Bricolage Grotesque',sans-serif; font-size:11px; font-weight:700; color:var(--hawke); }

  .insight-block { margin-top:10px; padding:9px 11px; border-radius:8px; font-size:11.5px; line-height:1.6; color:var(--text-muted); font-style:italic; }
  .ib-flash{background:var(--flash-light);border:1px solid var(--flash-border);border-left:2.5px solid var(--flash);}
  .ib-sherlock{background:var(--sherlock-light);border:1px solid var(--sherlock-border);border-left:2.5px solid var(--sherlock);}
  .ib-hawke{background:var(--hawke-light);border:1px solid var(--hawke-border);border-left:2.5px solid var(--hawke);}

  .hdivider { height:1px; background:var(--border-soft); margin:8px 0; }

  .footer { margin-top:14px; text-align:center; font-size:10px; color:var(--text-dim); letter-spacing:0.07em; text-transform:uppercase; }
  .footer strong { background:linear-gradient(90deg,var(--flash),var(--sherlock)); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
</style>
</head>
<body>
<div class="wrapper">
  <div class="header">
 Â Â  <div class="header-left">
 Â Â Â Â  <div class="pulse-ring"></div>
 Â Â Â Â  <div class="header-title">AI Lab Intelligence</div>
 Â Â  </div>
 Â Â  <div class="header-sub" id="lastUpdated"></div>
  </div>
  <div class="stack" id="stack">
 Â Â  <div class="loading"><div class="spinner"></div>Loading intelligenceâ€¦</div>
  </div>
  <div class="footer">Powered by <strong>LeadSquared AI Lab</strong></div>
</div>

<script>
  // â”€â”€ Config â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // Replace with your Render service URL after deployment
  const API_BASE = 'https://lead-intelligence-api.onrender.com';

  function pid() {
 Â Â  return new URL(window.location.href).searchParams.get('pid') || '';
  }

  function badgeHTML(val) {
 Â Â  const v = (val||'').toUpperCase();
 Â Â  const cls = v==='HIGH'?'badge-high':v==='LOW'?'badge-low':'badge-medium';
 Â Â  return `<span class="badge ${cls}">${val||'â€”'}</span>`;
  }

  function pillHTML(val, fallback) {
 Â Â  const display = val || fallback || 'Active';
 Â Â  const v = display.toLowerCase();
 Â Â  const cls = v==='active'?'pill-active':v==='review'?'pill-review':v==='pending'?'pill-pending':'pill-none';
 Â Â  return `<div class="pill ${cls}">${display}</div>`;
  }

  function cardHTML(barCls, iconCls, emoji, name, role, pillVal, pillFallback, body) {
 Â Â  return `<div class="card">
 Â Â Â Â  <div class="card-bar ${barCls}"></div>
 Â Â Â Â  <div class="card-head">
 Â Â Â Â Â Â  <div class="agent-id">
 Â Â Â Â Â Â Â Â  <div class="agent-icon ${iconCls}">${emoji}</div>
 Â Â Â Â Â Â Â Â  <div><div class="agent-name">${name}</div><div class="agent-role">${role}</div></div>
 Â Â Â Â Â Â  </div>
 Â Â Â Â Â Â  ${pillHTML(pillVal, pillFallback)}
 Â Â Â Â  </div>
 Â Â Â Â  <div class="card-body">${body}</div>
 Â Â  </div>`;
  }

  function render(d) {
 Â Â  const stack = document.getElementById('stack');
 Â Â  stack.innerHTML = '';
 Â Â  let count = 0;

 Â Â  // â”€â”€ Flash â”€â”€
 Â Â  if (d.mx_AI_Readiness_Score || d.mx_Readiness_Bucket || d.mx_AI_Detected_Intent || d.mx_AI_Reasoning) {
 Â Â Â Â  const n = Math.min(100, Math.max(0, parseInt(d.mx_AI_Readiness_Score)||0));
 Â Â Â Â  const offset = (119.38 - (n/100)*119.38).toFixed(2);
 Â Â Â Â  const bktCls = (d.mx_Readiness_Bucket||'').toLowerCase()==='high'?'bkt-high':(d.mx_Readiness_Bucket||'').toLowerCase()==='medium'?'bkt-medium':'bkt-low';
 Â Â Â Â  const body = `
 Â Â Â Â Â Â  <div class="score-hero">
 Â Â Â Â Â Â Â Â  <div class="score-ring"><svg viewBox="0 0 46 46">
 Â Â Â Â Â Â Â Â Â Â  <circle class="ring-bg" cx="23" cy="23" r="19"/>
 Â Â Â Â Â Â Â Â Â Â  <circle class="ring-fill" id="fring" cx="23" cy="23" r="19" stroke-dasharray="119.38" stroke-dashoffset="119.38"/>
 Â Â Â Â Â Â Â Â  </svg><div class="score-num">${n||'â€”'}</div></div>
 Â Â Â Â Â Â Â Â  <div><div class="score-label">Readiness Score</div><div class="score-bucket ${bktCls}">${d.mx_Readiness_Bucket||'â€”'}</div></div>
 Â Â Â Â Â Â  </div>
 Â Â Â Â Â Â  <div class="fields">
 Â Â Â Â Â Â Â Â  ${d.mx_AI_Detected_Intent ? `<div class="field"><div class="f-label">Detected Intent</div><div class="f-val c-flash">${d.mx_AI_Detected_Intent}</div></div>` : ''}
 Â Â Â Â Â Â  </div>
 Â Â Â Â Â Â  ${d.mx_AI_Reasoning ? `<div class="insight-block ib-flash"><div class="f-label" style="margin-bottom:4px;font-style:normal">AI Reasoning</div>${d.mx_AI_Reasoning}</div>` : ''}`;
 Â Â Â Â  stack.innerHTML += cardHTML('bar-flash','icon-flash','âš¡','Agent Flash','60 Seconds to Schedule','Active','Active',body);
 Â Â Â Â  setTimeout(()=>{ const r=document.getElementById('fring'); if(r) r.style.strokeDashoffset=offset; },150);
 Â Â Â Â  count++;
 Â Â  }

 Â Â  // â”€â”€ Sherlock â”€â”€
 Â Â  if (d.mx_QA_Status || d.mx_QA_Risk_Level || d.mx_QA_Summary || d.mx_QA_Key_Findings) {
 Â Â Â Â  const body = `
 Â Â Â Â Â Â  <div class="two-col">
 Â Â Â Â Â Â Â Â  <div class="field"><div class="f-label">QA Status</div><div class="f-val c-sherlock">${d.mx_QA_Status||'â€”'}</div></div>
 Â Â Â Â Â Â Â Â  <div class="field"><div class="f-label">Risk Level</div>${badgeHTML(d.mx_QA_Risk_Level)}</div>
 Â Â Â Â Â Â  </div>
 Â Â Â Â Â Â  <div class="fields">
 Â Â Â Â Â Â Â Â  ${d.mx_QA_SummaryÂ Â  ? `<div class="field"><div class="f-label">QA Summary</div><div class="f-val">${d.mx_QA_Summary}</div></div>` : ''}
 Â Â Â Â Â Â Â Â  ${d.mx_QA_Key_Findings ? `<div class="field"><div class="f-label">Key Findings</div><div class="f-val">${d.mx_QA_Key_Findings}</div></div>` : ''}
 Â Â Â Â Â Â Â Â  ${d.mx_QA_Advisory_Notes ? `<div class="field"><div class="f-label">Advisory Notes</div><div class="f-val">${d.mx_QA_Advisory_Notes}</div></div>` : ''}
 Â Â Â Â Â Â  </div>
 Â Â Â Â Â Â  ${d.mx_QA_Concerns ? `<div class="insight-block ib-sherlock">${d.mx_QA_Concerns}</div>` : ''}`;
 Â Â Â Â  stack.innerHTML += cardHTML('bar-sherlock','icon-sherlock','ğŸ”','Agent Sherlock','Application QA Review',d.mx_QA_Status,'Review',body);
 Â Â Â Â  count++;
 Â Â  }

 Â Â  // â”€â”€ Hawke â”€â”€
 Â Â  if (d.mx_Latest_Anomaly_Type || d.mx_Latest_Anomaly_Severity || d.mx_Latest_Anomaly_Confidence || d.mx_Latest_Anomaly_Explanation) {
 Â Â Â Â  const hN = Math.min(100, Math.max(0, parseInt(d.mx_Latest_Anomaly_Confidence)||0));
 Â Â Â Â  const body = `
 Â Â Â Â Â Â  <div class="two-col">
 Â Â Â Â Â Â Â Â  <div class="field"><div class="f-label">Anomaly Type</div><span class="anomaly-chip">${d.mx_Latest_Anomaly_Type||'â€”'}</span></div>
 Â Â Â Â Â Â Â Â  <div class="field"><div class="f-label">Severity</div>${badgeHTML(d.mx_Latest_Anomaly_Severity)}</div>
 Â Â Â Â Â Â  </div>
 Â Â Â Â Â Â  <div class="fields">
 Â Â Â Â Â Â Â Â  <div class="field"><div class="f-label">Confidence</div>
 Â Â Â Â Â Â Â Â Â Â  <div class="conf-wrap">
 Â Â Â Â Â Â Â Â Â Â Â Â  <div class="conf-track"><div class="conf-fill cf-hawke" id="hbar" style="width:0%"></div></div>
 Â Â Â Â Â Â Â Â Â Â Â Â  <div class="conf-num">${hN||'â€”'}</div>
 Â Â Â Â Â Â Â Â Â Â  </div>
 Â Â Â Â Â Â Â Â  </div>
 Â Â Â Â Â Â Â Â  ${d.mx_Last_Intelligence_Run ? `<div class="field"><div class="f-label">Last Intelligence Run</div><div class="f-val c-hawke">${d.mx_Last_Intelligence_Run}</div></div>` : ''}
 Â Â Â Â Â Â  </div>
 Â Â Â Â Â Â  ${d.mx_Latest_Anomaly_Explanation ? `<div class="insight-block ib-hawke">${d.mx_Latest_Anomaly_Explanation}</div>` : ''}`;
 Â Â Â Â  stack.innerHTML += cardHTML('bar-hawke','icon-hawke','ğŸ¦…','Agent Hawke','Anomaly Detection',d.mx_AI_Anomaly_Status,'Active',body);
 Â Â Â Â  setTimeout(()=>{ const b=document.getElementById('hbar'); if(b) b.style.width=hN+'%'; },200);
 Â Â Â Â  count++;
 Â Â  }

 Â Â  // â”€â”€ Invorto â”€â”€
 Â Â  if (d.mx_Primary_Hesitation || d.mx_Motivation_Trigger || d.mx_Decision_Owner || d.mx_Enrollment_Timeline_Voice_Call) {
 Â Â Â Â  const body = `<div class="fields">
 Â Â Â Â Â Â  ${d.mx_Primary_Hesitation ? `<div class="field"><div class="f-label">Primary Hesitation</div><div class="f-val">${d.mx_Primary_Hesitation}</div></div>` : ''}
 Â Â Â Â Â Â  ${d.mx_Motivation_Trigger ? `<div class="field"><div class="f-label">Motivation Trigger</div><div class="f-val c-invorto">${d.mx_Motivation_Trigger}</div></div>` : ''}
 Â Â Â Â Â Â  ${(d.mx_Decision_Owner || d.mx_Enrollment_Timeline_Voice_Call) ? '<div class="hdivider"></div>' : ''}
 Â Â Â Â Â Â  ${d.mx_Decision_Owner ? `<div class="field"><div class="f-label">Decision Owner</div><div class="f-val">${d.mx_Decision_Owner}</div></div>` : ''}
 Â Â Â Â Â Â  ${d.mx_Enrollment_Timeline_Voice_Call ? `<div class="field"><div class="f-label">Enrollment Timeline</div><div class="f-val">${d.mx_Enrollment_Timeline_Voice_Call}</div></div>` : ''}
 Â Â Â Â  </div>`;
 Â Â Â Â  stack.innerHTML += cardHTML('bar-invorto','icon-invorto','ğŸ™ï¸','Invorto Voice','Call Qualification','Active','Active',body);
 Â Â Â Â  count++;
 Â Â  }

 Â Â  if (count === 0) {
 Â Â Â Â  stack.innerHTML = `<div class="all-empty">
 Â Â Â Â Â Â  <div class="all-empty-emoji">ğŸ¤–</div>
 Â Â Â Â Â Â  <div class="all-empty-title">The agents are on standby.</div>
 Â Â Â Â Â Â  <div class="all-empty-sub">No analysis has been run on this lead yet.</div>
 Â Â Â Â  </div>`;
 Â Â  }

 Â Â  document.getElementById('lastUpdated').textContent =
 Â Â Â Â  'Updated ' + new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});
  }

  async function load() {
 Â Â  const id = pid();
 Â Â  if (!id) {
 Â Â Â Â  document.getElementById('stack').innerHTML = `<div class="all-empty">
 Â Â Â Â Â Â  <div class="all-empty-emoji">ğŸ”</div>
 Â Â Â Â Â Â  <div class="all-empty-title">No lead ID found.</div>
 Â Â Â Â Â Â  <div class="all-empty-sub">Make sure the Custom Tab URL includes ?pid={{ProspectID}}</div>
 Â Â Â Â  </div>`;
 Â Â Â Â  return;
 Â Â  }
 Â Â  try {
 Â Â Â Â  const res = await fetch(`${API_BASE}/lead-intelligence?pid=${id}`);
 Â Â Â Â  const json = await res.json();
 Â Â Â Â  if (json.success) {
 Â Â Â Â Â Â  render(json.data);
 Â Â Â Â  } else {
 Â Â Â Â Â Â  throw new Error(json.error || 'Unknown error');
 Â Â Â Â  }
 Â Â  } catch(err) {
 Â Â Â Â  document.getElementById('stack').innerHTML = `<div class="all-empty">
 Â Â Â Â Â Â  <div class="all-empty-emoji">âš ï¸</div>
 Â Â Â Â Â Â  <div class="all-empty-title">Could not load intelligence.</div>
 Â Â Â Â Â Â  <div class="all-empty-sub">${err.message}</div>
 Â Â Â Â  </div>`;
 Â Â  }
  }

  load();
</script>
</body>
</html>

